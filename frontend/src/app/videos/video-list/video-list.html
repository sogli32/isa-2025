<div class="video-list-container">
  <div class="header">
    <h1>ğŸ¬ JutjubiÄ‡</h1>
    <p class="subtitle">Bez reklama. Zauvek.</p>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>UÄitavanje videa...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading" class="error">
    {{ error }}
  </div>

  <div class="controls-container">
  <div class="radius-control" *ngIf="activeTab === 'nearby' || activeTab === 'popularNearby'">
    <label for="radiusRange">Radijus pretrage: <strong>{{ selectedRadius }} km</strong></label>
    <input 
      type="range" 
      id="radiusRange" 
      min="1" 
      max="500" 
      [(ngModel)]="selectedRadius" 
      (change)="onRadiusChange()"
      class="radius-slider"
    >
  </div>

  <div class="tabs">
  <button [class.active]="activeTab === 'newest'" (click)="setTab('newest')">Najnovije</button>
  <button [class.active]="activeTab === 'trending'" (click)="setTab('trending')">Trending</button>
  <button [class.active]="activeTab === 'nearby'" (click)="setTab('nearby')">U blizini</button>
  <button [class.active]="activeTab === 'popularNearby'" (click)="setTab('popularNearby')">Popular u blizini</button>
<button [class.active]="activeTab === 'etlPopular'" (click)="setTab('etlPopular')">
  Popular (7 dana)
</button>

</div>

  <!-- ETL Popular videi - prikaz kada je tab aktivan -->
  <div *ngIf="activeTab === 'etlPopular' && !loading && !error && etlPopularVideos.length > 0" class="etl-popular-section">
    <p class="etl-subtitle">Poslednje izvrÅ¡avanje ETL-a: {{ formatEtlDate(etlExecutedAt) }}</p>
    <div class="etl-video-grid">
      <div
        *ngFor="let entry of etlPopularVideos; let i = index"
        class="etl-video-card"
        (click)="openVideo(entry.videoId)"
      >
        <div class="etl-rank">#{{ i + 1 }}</div>
        <div class="etl-thumbnail-wrapper">
          <img
            [src]="getThumbnailUrl(entry.videoId)"
            [alt]="entry.title"
            class="thumbnail"
          />
        </div>
        <div class="etl-video-info">
          <h3 class="video-title">{{ entry.title }}</h3>
          <p class="video-meta">
            <span class="username">{{ entry.username }}</span>
          </p>
          <p class="etl-score">Popularity score: {{ entry.popularityScore | number:'1.0-0' }}</p>
          <p class="etl-views">Pregleda: {{ formatViewCount(entry.viewCount) }}</p>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="activeTab === 'etlPopular' && !loading && !error && etlPopularVideos.length === 0" class="empty-state">
    <p>ğŸ“¹ Nema popularnih videa iz ETL-a</p>
    <p class="empty-subtitle">ETL pipeline joÅ¡ nije pokrenut ili nema dovoljno pregleda.</p>
  </div>

  <!-- Video grid (nije za ETL tab) -->
  <div *ngIf="!loading && !error && activeTab !== 'etlPopular'" class="video-grid">
    <div 
      *ngFor="let video of videos" 
      class="video-card"
      (click)="openVideo(video.id)"
    >
      <div class="thumbnail-wrapper">
  <img 
    [src]="getThumbnailUrl(video.id)" 
    [alt]="video.title"
    class="thumbnail"
  />

  <!-- Zakazani video badge -->
    <div *ngIf="video.scheduledAt && !video.available" class="scheduled-badge">
      ğŸ“… Zakazano za {{ formatScheduledDate(video.scheduledAt) }}
    </div>

    <div class="view-count-badge" *ngIf="!video.scheduledAt || video.available">
      ğŸ‘ï¸ {{ formatViewCount(video.viewCount) }}
    </div>
  </div>


      <div class="video-info">
        <h3 class="video-title">{{ video.title }}</h3>
        <p class="video-meta">
          <span class="username">{{ video.username }}</span>
          <span class="separator">â€¢</span>
          <span class="date">{{ formatDate(video.createdAt) }}</span>
        </p>
        <div class="tags" *ngIf="video.tags">
          <span 
            *ngFor="let tag of video.tags.split(',').slice(0, 3)" 
            class="tag"
          >
            #{{ tag.trim() }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty state (nije za ETL tab) -->
  <div *ngIf="!loading && !error && videos.length === 0 && activeTab !== 'etlPopular'" class="empty-state">
    <p>ğŸ“¹ Nema videa za prikaz</p>
    <p class="empty-subtitle">Budite prvi koji Ä‡e postaviti video!</p>
  </div>
</div>
